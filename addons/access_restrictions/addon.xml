<?xml version="1.0"?>
<addon scheme="2.0">
	<id>access_restrictions</id>
	<name>Access restrictions</name>
	<description>Lets you limit storefront and administrator area access to certain IP-addresses with different options</description>
	<version>1.0</version>
	<priority>2700</priority>
	<position>200</position>
	<status>active</status>
	<dependencies/>
	<translations>
		<item for="name" lang="ES">Restricciones de acceso</item>
		<item for="name" lang="FR">Restrictions d'accès</item>
		<item for="name" lang="DA">adgangsbegrænsninger</item>
		<item for="name" lang="EL">Περιορισμοί πρόσβασης</item>
		<item for="name" lang="IT">Restrizione accessi</item>
		<item for="name" lang="RO">Restricții acces</item>
		<item for="name" lang="RU">Ограничение доступа</item>
		<item for="name" lang="SI">Omejitev dostopa</item>
		<item for="description" lang="RU">Позволяет ограничить доступ к витрине магазина и администраторской части с разных IP-адресов с применением различных настроек</item>
	</translations>
	<auto_install>PROFESSIONAL,MULTIVENDOR,ULTIMATE</auto_install>
	<settings edition_type="ROOT">
		<sections>
			<section id="general">
				<name>General</name>
				<items>
					<item id="elm_administrator_area_settings">
						<name>Administrator area settings</name>
						<type>header</type>
						<handler/>
						<translations>
							<item lang="ES">Opciones de Área de Administración</item>
							<item lang="FR">Administrator area settings</item>
							<item lang="DA">Administration panel indstillinger</item>
							<item lang="EL">Ρυθμίσεις του πίνακα επιλογών διαχειριστή</item>
							<item lang="RO">Setări Panou de administrare</item>
							<item lang="RU">Настройки администраторской части</item>
							<item lang="SI">Nastavitve upravnega panela</item>
						</translations>
					</item>
					<item id="admin_reverse_ip_access">
						<name>Allow login to the admin area from specified IPs only</name>
						<type>checkbox</type>
						<default_value/>
						<translations>
							<item lang="ES">Permitir el acceso al área de administración sólo de las IPS especificadas</item>
							<item lang="FR">Allow login to the admin area from specified IPs only</item>
							<item lang="EL">Είσοδος στον πίνακα επιλογών του διαχειρηστή από τις προκαθορισμένες διευθύνσεις IP μόνο</item>
							<item lang="RO">Autentificare la panoul de administrare doar de la IP-urile specificate</item>
							<item lang="RU">Позволять входить в администраторскую часть только с определённых IP-адресов</item>
							<item lang="SI">Prijava v admin panel samo iz določenih IP-jev</item>
						</translations>
					</item>
					<item id="unsuccessful_attempts_login">
						<name>Block IP after a number of unsuccessful attempts</name>
						<type>checkbox</type>
						<default_value/>
						<translations>
							<item lang="ES">Bloquee IP después de varias tentativas fracasadas</item>
							<item lang="EL">Αποκλεισμός IP μετά από μια σειρά αποτυχημένων προσπαθειών</item>
							<item lang="RO">Blochează IP-ul după nu anumit număr de autentificări nereușite</item>
							<item lang="RU">Блокировать IP после определенного кол-ва неудачных попыток входа</item>
							<item lang="SI">Blokiranje IP-ja po več neuspešnih poskusih</item>
						</translations>
					</item>
					<item id="number_unsuccessful_attempts">
						<name>Number of unsuccessful attempts</name>
						<type>input</type>
						<default_value>5</default_value>
						<translations>
							<item lang="ES">Número de tentativas fracasadas</item>
							<item lang="DA">Antal mislykkede forsøg</item>
							<item lang="EL">Αριθμός ανεπιτυχών προσπαθειών</item>
							<item lang="RO">Numărul de încercări nereușite</item>
							<item lang="RU">Кол-во неудачных попыток входа</item>
							<item lang="SI">Število neuspešnih poskusih</item>
						</translations>
					</item>
					<item id="login_intervals">
						<name>Time between unsuccessful login attempts (seconds)</name>
						<type>input</type>
						<default_value>60</default_value>
						<translations>
							<item lang="ES">Tiempo entre tentativas de entrada al sistema fracasadas (segundos)</item>
							<item lang="EL">Χρόνος μεταξύ ανεπιτυχών προσπάθειών σύνδεσης (δευτερόλεπτα)</item>
							<item lang="RO">Timpul dintre încercările de autentificare nereușite (secunde)</item>
							<item lang="RU">Время между неудачными попытками входа (секунды)</item>
							<item lang="SI">Čas med neuspelimi poskusi prijave (v sekundah)</item>
						</translations>
					</item>
					<item id="time_block">
						<name>Time for which the IP should be blocked (hours)</name>
						<type>input</type>
						<default_value>24</default_value>
						<translations>
							<item lang="ES">El tiempo durante el cual la IP debería ser bloqueada (horas)</item>
							<item lang="FR">Time for which the IP should be blocked (hours)</item>
							<item lang="EL">Διάστημα για το οποίο IP θα πρέπει να αποκλειστεί (σε ώρες)</item>
							<item lang="RO">Timpul pentru care un IP să fie blochat (ore)</item>
							<item lang="RU">Время, на которое блокируется IP (часы)</item>
							<item lang="SI">Čas za katerega se blokira IP (ur)</item>
						</translations>
					</item>
					<item id="elm_customer_and_affiliate_area_settings">
						<name>Customer and Affiliate area settings</name>
						<type>header</type>
						<handler/>
						<translations>
							<item lang="ES">Opciones de área de clientes y afiliados</item>
							<item lang="FR">Customer and Affiliate area settings</item>
							<item lang="DA">Kunde indstillinger</item>
							<item lang="EL">Ρυθμίσεις πελάτη</item>
							<item lang="RO">Setări Client</item>
							<item lang="RU">Настройки витрины магазина и партнёрской части</item>
							<item lang="SI">Strankine nastavitve</item>
						</translations>
					</item>
					<item id="unsuccessful_attempts_login_customer">
						<name>Block IP after a number of unsuccessful attempts</name>
						<type>checkbox</type>
						<default_value/>
						<translations>
							<item lang="ES">Bloquee IP después de varias tentativas fracasadas</item>
							<item lang="EL">Αποκλεισμός της IP μετά από μια σειρά αποτυχημένων προσπαθειών</item>
							<item lang="RO">Blochează IP-ul după o serie de autentificări nereușite</item>
							<item lang="RU">Блокировать IP после определенного кол-ва неудачных попыток входа</item>
							<item lang="SI">Blokiranje IP-ja po več neuspešnih poskusih</item>
						</translations>
					</item>
					<item id="number_unsuccessful_attempts_customer">
						<name>Number of unsuccessful attempts</name>
						<type>input</type>
						<default_value>5</default_value>
						<translations>
							<item lang="ES">Número de tentativas fracasadas</item>
							<item lang="DA">Antal mislykkede forsøg</item>
							<item lang="EL">Αριθμός ανεπιτυχών προσπαθειών</item>
							<item lang="RO">Numărul de încercări nereușite</item>
							<item lang="RU">Кол-во неудачных попыток входа</item>
							<item lang="SI">Število neuspešnih poskusov</item>
						</translations>
					</item>
					<item id="login_intervals_customer">
						<name>Time between unsuccessful login attempts (seconds)</name>
						<type>input</type>
						<default_value>60</default_value>
						<translations>
							<item lang="ES">Tiempo entre tentativas de entrada al sistema fracasadas (segundos)</item>
							<item lang="EL">Χρόνος μεταξύ ανεπιτυχών προσπάθειών σύνδεσης (δευτερόλεπτα)</item>
							<item lang="RO">Timpul dintre încercările de autentificare nereușite (secunde)</item>
							<item lang="RU">Время между неудачными попытками входа (секунды)</item>
							<item lang="SI">Čas med neuspelimi poskusi prijave (v sekundah)</item>
						</translations>
					</item>
					<item id="time_block_customer">
						<name>Time for which the IP should be blocked (hours)</name>
						<type>input</type>
						<default_value>24</default_value>
						<translations>
							<item lang="ES">El tiempo durante el cual la IP debería ser bloqueada (horas)</item>
							<item lang="FR">Time for which the IP should be blocked (hours)</item>
							<item lang="EL">Διάστημα για το οποίο IP θα πρέπει να αποκλειστεί (σε ώρες)</item>
							<item lang="RO">Timpul pentru care un IP să fie blochat (ore)</item>
							<item lang="RU">Время, на которое блокируется IP (часы)</item>
							<item lang="SI">Čas za katerega se blokira IP (ur)</item>
						</translations>
					</item>
				</items>
			</section>
		</sections>
	</settings>
	<queries>
		<item>DROP TABLE IF EXISTS ?:access_restriction_block;</item>
		<item>DROP TABLE IF EXISTS ?:access_restriction;</item>
		<item>DROP TABLE IF EXISTS ?:access_restriction_reason_descriptions;</item>
		<item>
			CREATE TABLE `?:access_restriction_block` (
				`ip` int(11) unsigned NOT NULL default '0',
				`tries` smallint(5) unsigned NOT NULL default '0',
				`timestamp` int(11) unsigned NOT NULL default '0', 
				`expires` int(11) unsigned NOT NULL default '0',
				PRIMARY KEY  (`ip`)
			) Engine=MyISAM DEFAULT CHARSET UTF8;
		</item>
		<!--
		/********************
		*
		* field "type" in
		* ipr - IP range for customer area
		* ips - Specific IP address for customer area
		* ipb - Blocked ip after number of faisled logins (customer and partner area)
		* aar - Admin area IPs range
		* aas - Admin area specific IPs
		* aab - Blocked ip after number of failed logins (admin area)
		* cc - Credit card numbers
		* es - E-Mail addresses
		* ed - E-Mail domain
		* d - Domains
		*
		*/
		-->
		<item>
			CREATE TABLE `?:access_restriction` (
				`item_id` mediumint(8) unsigned NOT NULL auto_increment,
				`value` varchar(66) NOT NULL default '',
				`ip_from` int(11) unsigned NOT NULL default '0',
				`ip_to` int(11) unsigned NOT NULL default '0',
				`type` char(3) NOT NULL default '',
				`status` char(1) NOT NULL default 'A', 
				`timestamp` int(11) unsigned NOT NULL default '0',
				`expires` int(11) unsigned NOT NULL default '0', 
				PRIMARY KEY  (`item_id`),  KEY `type` (`type`)
			) Engine=MyISAM DEFAULT CHARSET UTF8;
		</item>
		<item>
			CREATE TABLE `?:access_restriction_reason_descriptions` (
				`item_id` mediumint(8) unsigned NOT NULL auto_increment,
				`type` char(3) NOT NULL default '', 
				`reason` mediumtext NOT NULL,
				`lang_code` char(2) NOT NULL default 'EN', 
				PRIMARY KEY  (`item_id`,`type`,`lang_code`)
			) Engine=MyISAM DEFAULT CHARSET UTF8;
		</item>
		<item table="privilege_descriptions" lang="EN" editions="PROFESSIONAL,MULTIVENDOR,ULTIMATE">REPLACE INTO ?:privilege_descriptions (privilege, description, lang_code, section_id) VALUES ('manage_access_restrictions', 'Manage access restrictions', 'EN', '1');</item>
		<item table="privilege_descriptions" lang="RU" editions="PROFESSIONAL,MULTIVENDOR,ULTIMATE">REPLACE INTO ?:privilege_descriptions (privilege, description, lang_code, section_id) VALUES ('manage_access_restrictions', 'Управление ограничением доступа', 'RU', '1');</item>
		<item editions="PROFESSIONAL,MULTIVENDOR,ULTIMATE">REPLACE INTO ?:privileges (privilege, is_default) VALUES ('manage_access_restrictions', 'Y');</item>
		<item for="uninstall" editions="PROFESSIONAL,MULTIVENDOR,ULTIMATE">DELETE FROM ?:privileges WHERE privilege LIKE 'manage_access_restrictions'</item>
		<item for="uninstall" editions="PROFESSIONAL,MULTIVENDOR,ULTIMATE">DELETE FROM ?:privilege_descriptions WHERE privilege LIKE 'manage_access_restrictions'</item>
		<item for="uninstall">DROP TABLE IF EXISTS ?:access_restriction_block;</item>
		<item for="uninstall">DROP TABLE IF EXISTS ?:access_restriction;</item>
		<item for="uninstall">DROP TABLE IF EXISTS ?:access_restriction_reason_descriptions;</item>
	</queries>
	<language_variables>
		<item lang="EN" id="add_ips">Add IPs</item>
		<item lang="EN" id="new_ips">New IPs</item>
		<item lang="EN" id="add_domains">Add domains</item>
		<item lang="EN" id="new_domains">New domains</item>
		<item lang="EN" id="add_emails">Add e-mail addresses</item>
		<item lang="EN" id="new_emails">New e-mail addresses</item>

		<item lang="BG" id="add_ips">Добави нов IPs</item>
		<item lang="BG" id="add_domains">Добави домейн</item>
		<item lang="BG" id="new_emails">Добави Email</item>

		<item lang="DA" id="add_ips">Tilføj nye IP-adresser</item>
		<item lang="DA" id="add_domains">Tilføj nye domæner</item>
		<item lang="DA" id="new_emails">Tilføj ny e-mail</item>

		<item lang="EL" id="add_ips">Προσθήκη νέας IP</item>
		<item lang="EL" id="add_domains">Προσθήκη νέου ονόματος χώρου</item>
		<item lang="EL" id="new_emails">Προσθήκη νέας διεύθυνσης e-mail</item>

		<item lang="ES" id="add_ips">Añadir nuevas IPs</item>
		<item lang="ES" id="add_domains">Añadir nuevo dominio</item>
		<item lang="ES" id="new_emails">Añadir nuevas direcciones de E-mail</item>

		<item lang="FR" id="add_ips">Ajouter des nouvelles adresses IP</item>
		<item lang="FR" id="add_domains">Ajouter des nouveaux domaines</item>
		<item lang="FR" id="new_emails">Ajouter des nouvelles adresses emails</item>

		<item lang="NO" id="add_ips">Legg til nye IP'er</item>
		<item lang="NO" id="add_domains">Legg til nye domener</item>
		<item lang="NO" id="new_emails">Legg til nye e-postadresser</item>

		<item lang="RO" id="add_ips">Adăugați IP-uri noi</item>
		<item lang="RO" id="add_domains">Adăugați noi domenii</item>
		<item lang="RO" id="new_emails">Adăugați adrese de e-mail noi</item>

		<item lang="RU" id="add_ips">Добавить новые IP адреса</item>
		<item lang="RU" id="add_domains">Добавить новые домены</item>
		<item lang="RU" id="new_emails">Добавить новые e-mail адреса</item>

		<item lang="SI" id="add_ips">Dodaj nove IP-je</item>
		<item lang="SI" id="add_domains">Dodajte nove domene</item>
		<item lang="SI" id="new_emails">Dodaj nove E-poštne naslove</item>
	</language_variables>
</addon>
